# Crown Social Network - Render Deployment Guide üöÄ

## üìã Prerequisites

1. **Render Account**: Sign up at [render.com](https://render.com)
2. **GitHub Repository**: Push your code to GitHub
3. **MongoDB Atlas**: Set up a MongoDB Atlas cluster (or use Render's PostgreSQL if preferred)

## üîß Step-by-Step Deployment

### Step 1: Prepare Your Repository

1. **Commit all changes to Git:**
```bash
git add .
git commit -m "Prepare for Render deployment with Socket.IO support"
git push origin main
```

### Step 2: Create Render Services

#### Option A: Using render.yaml (Recommended)
1. **Connect Repository**: In Render dashboard, click "New" ‚Üí "Blueprint"
2. **Connect GitHub**: Select your crown-social repository
3. **Review Configuration**: Render will automatically read `render.yaml`
4. **Deploy**: Click "Apply" to create services

#### Option B: Manual Setup
1. **Create Web Service**: 
   - Click "New" ‚Üí "Web Service"
   - Connect your GitHub repository
   - Set the following:
     - **Name**: `crown-social-network`
     - **Environment**: `Node`
     - **Build Command**: `npm install`
     - **Start Command**: `npm start`
     - **Plan**: `Starter` (Free tier)

2. **Create Database** (if not using MongoDB Atlas):
   - Click "New" ‚Üí "PostgreSQL" (or use MongoDB Atlas)
   - **Name**: `crown-mongodb`
   - **Plan**: `Starter`

### Step 3: Configure Environment Variables

In your Render service dashboard, add these environment variables:

#### Required Variables:
```bash
NODE_ENV=production
PORT=3000
```

#### Database (choose one):
```bash
# Option 1: MongoDB Atlas
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/crown?retryWrites=true&w=majority

# Option 2: Render PostgreSQL (automatically provided)
DATABASE_URL=(automatically set by Render)
```

#### Security (Generated by Render):
```bash
JWT_SECRET=(click "Generate")
SESSION_SECRET=(click "Generate")
```

#### Email Configuration (Optional):
```bash
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_app_password
```

#### OAuth Configuration (Optional):
```bash
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
FACEBOOK_APP_ID=your_facebook_app_id
FACEBOOK_APP_SECRET=your_facebook_app_secret
```

### Step 4: Update OAuth Redirect URLs

After deployment, update your OAuth app settings:

#### Google OAuth:
- **Authorized Origins**: `https://your-app-name.onrender.com`
- **Redirect URIs**: `https://your-app-name.onrender.com/auth/google/callback`

#### Facebook OAuth:
- **Valid OAuth Redirect URIs**: `https://your-app-name.onrender.com/auth/facebook/callback`

### Step 5: Deploy and Test

1. **Deploy**: Render will automatically deploy when you push to main branch
2. **Monitor Logs**: Check deployment logs in Render dashboard
3. **Test Health Check**: Visit `https://your-app-name.onrender.com/health`
4. **Test Socket.IO**: Real-time features should work automatically

## üîç Monitoring and Troubleshooting

### Health Checks
- **Primary**: `/health`
- **API Health**: `/api/health`
- **Database**: `/health/database`
- **Services**: `/health/services`

### Common Issues and Solutions

#### 1. Build Failures
```bash
# Check build logs for missing dependencies
npm install --save missing-package-name
```

#### 2. Database Connection Issues
```bash
# Verify MONGODB_URI format
mongodb+srv://username:password@cluster.mongodb.net/dbname?retryWrites=true&w=majority
```

#### 3. Environment Variable Issues
```bash
# Ensure all required variables are set in Render dashboard
# Use "Generate" for JWT_SECRET and SESSION_SECRET
```

#### 4. Socket.IO Connection Issues
```bash
# Socket.IO should work automatically with Render
# Check browser console for WebSocket connection errors
# Verify that Socket.IO client connects to correct URL
```

### Performance Optimization

#### 1. Enable Caching
```bash
CACHE_ENABLED=true
CACHE_TTL=3600
```

#### 2. Optimize Database Queries
- Use MongoDB indexes
- Enable connection pooling
- Set appropriate timeout values

#### 3. Enable Compression
```bash
COMPRESSION_ENABLED=true
```

## üìä Post-Deployment Checklist

- [ ] Health check endpoint responds (200 OK)
- [ ] Database connection established
- [ ] User registration/login works
- [ ] File upload functionality works
- [ ] Socket.IO real-time features work
- [ ] OAuth providers work (if configured)
- [ ] Email notifications work (if configured)
- [ ] API endpoints respond correctly
- [ ] Mobile responsiveness verified
- [ ] HTTPS certificate active

## üîÑ Continuous Deployment

Render automatically deploys when you push to the main branch:

```bash
git add .
git commit -m "Update feature"
git push origin main
# Deployment starts automatically
```

## üí° Pro Tips

1. **Use Render's Auto-Deploy**: Enable auto-deploy from your main branch
2. **Monitor Resource Usage**: Check CPU/Memory usage in dashboard
3. **Enable Health Checks**: Render will restart if health checks fail
4. **Use Render Secrets**: For sensitive environment variables
5. **Set up Custom Domain**: Configure your own domain in Render dashboard

## üÜò Support

- **Render Docs**: [render.com/docs](https://render.com/docs)
- **Socket.IO Docs**: [socket.io/docs](https://socket.io/docs)
- **Crown Social Network**: Check project README.md

## üéâ Success!

Your Crown Social Network is now deployed on Render with:
- ‚úÖ Socket.IO real-time communication
- ‚úÖ Full-stack Node.js application
- ‚úÖ MongoDB database integration
- ‚úÖ Auto-scaling and high availability
- ‚úÖ HTTPS enabled by default
- ‚úÖ Automatic deployments from Git

**Deployment URL**: `https://your-service-name.onrender.com`
